# 学習管理システム v2.1

複数の会員制学校を統合管理するための学習管理システムです。

## 機能概要

### 管理者機能
- 学生管理（登録、編集、削除）
- 学校管理（登録、編集、削除）
- 管理者管理（総管理者のみ）
- **パスワード管理**
  - 自分のパスワード変更（総管理者・管理者）
  - 他の管理者のパスワードリセット（総管理者のみ）
- **レポート機能**（4種類のデータエクスポート）
  1. 学生データ（学生証番号、名前、学校、登録日）
  2. 学校学習データ（学校、日付、学習人数、学習時間合計）
  3. 学生学習データ（合計）（学生証番号、名前、学習日数合計、学習時間合計）
  4. 学生学習データ（個人）（学生証番号、名前、日付、学校、登校時間、下校時間、学習時間合計）
- **データ同期機能**（NEW）
  - データエクスポート/インポート
  - 19時自動下校処理

### 学校機能
- QRコードスキャンによる登校・下校管理
  - 当日1回目の読み取り → 登校
  - 当日2回目の読み取り → 下校
- 本日の出席状況リアルタイム表示
- 月別出席データ表示
- 学生別出席統計
- **データ同期機能**（NEW）
  - データエクスポート/インポート
  - 19時自動下校処理

## 学生データ項目（個人情報保護対応）

システムで管理する学生情報は以下の4項目のみです：
- 登録日（自動）
- 学生証番号（自動採番）
- 名前（カタカナ）
- 登録学校

## 🎯 推奨運用フロー（学校独立運用）

### 毎日の運用手順

#### 朝（開始時）
1. **パソコン（管理者画面）**
   - 「データ同期」タブを開く
   - 「全データをエクスポート」をクリック
   - JSONファイルをiPadに転送（AirDrop、メール、Googleドライブ等）

2. **iPad（学校管理画面）**
   - 学校アカウントでログイン
   - 「データ同期」タブを開く
   - エクスポートしたJSONファイルを選択
   - 「データをインポート」をクリック

#### 日中
3. **iPad（学校管理画面）**
   - QRコードスキャン画面で学生証を読み取り
   - 1回目 → 自動的に登校記録
   - 2回目 → 自動的に下校記録

#### 19時過ぎ
4. **iPad（学校管理画面）**
   - 「データ同期」タブを開く
   - 「本日の未下校者を19時で処理」ボタンをクリック
   - 未下校の学生が自動的に19:00下校として記録される

#### 夜（終了時）
5. **iPad（学校管理画面）**
   - 「データ同期」タブを開く
   - 「全データをエクスポート」をクリック
   - JSONファイルをパソコンに転送

6. **パソコン（管理者画面）**
   - 「データ同期」タブを開く
   - iPadから転送されたJSONファイルを選択
   - 「データをインポート」をクリック

### ファイル転送方法
- **AirDrop**（Mac ↔ iPad）: 最も簡単
- **メール**: ファイルを添付して送信
- **Googleドライブ/Dropbox等**: クラウドストレージ経由
- **USBケーブル**: ファイルアプリ経由

## セキュリティ機能

### パスワード管理
- **初回ログイン時のパスワード設定**: 新規管理者は初回ログイン時に必ずパスワードを設定
- **パスワード変更**: 総管理者・管理者が自身のパスワードを変更可能
- **パスワードリセット**: 総管理者が他の管理者のパスワードをリセット可能
- **パスワードポリシー**: 8文字以上、英字と数字を含む

### その他のセキュリティ
- 学校パスワードの ※※※※ 表示（画面上で非表示）
- ログアウト時の確実な画面遷移処理
- 役割ベースのアクセス制御

## 使用方法

### 初回ログイン（デフォルト管理者）
- メールアドレス: `admin@system.com`
- パスワード: `admin123`

### 学校の追加
1. 「学校管理」タブで「学校を追加」をクリック
2. 学校名、ログインID、パスワードを入力
3. 学校はこのログインIDとパスワードでログイン可能

### 学生の登録
1. 「学生管理」タブで「学生を追加」をクリック
2. 名前（カタカナ）と学校を選択
3. 学生証番号は自動で採番されます

### QRコードの発行
1. 学生一覧から「QRコード」ボタンをクリック
2. 表示されたQRコードを印刷または保存

### レポートの出力
1. 「レポート」タブを開く
2. 期間（開始日〜終了日）を選択して「期間を設定」をクリック
3. 出力したいレポートのボタンをクリック
4. CSVファイルがダウンロードされます

### データ同期
1. 「データ同期」タブを開く
2. エクスポート: 「全データをエクスポート」でJSONファイル保存
3. インポート: ファイルを選択して「データをインポート」

### 19時自動下校処理
1. 「データ同期」タブを開く
2. 「本日の未下校者を19時で処理」ボタンをクリック
3. 当日の未下校者が19:00下校として一括処理されます

## 技術仕様

- **フロントエンド**: HTML, CSS, JavaScript
- **データストレージ**: localStorage（ブラウザ内）
- **QRコード生成**: qrcodejs
- **QRコードスキャン**: html5-qrcode
- **データ形式**: JSON

## 注意事項

### データ管理
- 本システムはブラウザのlocalStorageにデータを保存します
- ブラウザのキャッシュをクリアするとデータが失われます
- **重要**: 定期的にデータをエクスポートしてバックアップしてください

### データ同期
- エクスポート/インポートは手動操作が必要です
- リアルタイム同期ではありません
- 1日2回（朝・夜）の同期を推奨します

### 本番環境での使用
実際の運用では以下の対応が推奨されます：
- バックエンドサーバーの構築
- データベースの導入
- パスワードの暗号化
- SSL/TLS通信の実装
- 自動バックアップシステム

## ファイル構成

- `index.html` - ログイン画面
- `auth.js` - 認証処理
- `set-password.html` - 初回パスワード設定画面
- `dashboard.html` - 管理者ダッシュボード
- `dashboard.js` - 管理者機能ロジック
- `school-dashboard.html` - 学校管理画面
- `school-dashboard.js` - 学校機能ロジック
- `qrcode.html` - QRコード表示ページ
- `README.md` - このファイル

## バージョン情報

- **バージョン**: 2.1
- **更新日**: 2025年
- **主な更新内容**:
  - 「苗字」を「名前」に変更
  - レポート機能の大幅改善（4種類のレポート対応）
  - 期間設定ベースのレポート出力
  - **データ同期機能の追加**（エクスポート/インポート）
  - **19時自動下校処理機能の追加**

## よくある質問（FAQ）

### Q: データ同期を忘れた場合はどうなりますか？
A: パソコンとiPadで別々のデータになります。最新のデータをエクスポートして同期してください。

### Q: 複数のiPadで同時に使用できますか？
A: 可能ですが、それぞれのiPadにデータをインポートする必要があります。

### Q: 19時の処理を忘れた場合は？
A: 翌日でも処理可能です。ただし「本日」の未下校者のみが対象です。

### Q: バックアップはどうすればいいですか？
A: 定期的に「全データをエクスポート」してJSONファイルを保存してください。

## サポート

問題が発生した場合は、システム管理者にお問い合わせください。
